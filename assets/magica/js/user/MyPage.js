define("underscore backbone backboneCommon ajaxControl command text!template/user/MyPage.html text!css/user/MyPage.css js/view/user/BannerView cardUtil text!template/etc/EtcPopup.html".split(" "),function(n,z,a,l,e,D,E,A,F,G){var p,m,h,c,f,v,q=null,r=null,u=0,y=z.View.extend({events:function(){var b={};b[a.cgti+" .live2dArea"]=this.touch;b["touchstart #live2dBtn"]=this.live2dSelectTimer;b[a.cgti+" #live2dBtn"]=this.live2dFuncRegacy;b[a.cgti+" #wearDecide"]=this.live2dSelectFunc;b[a.cgti+" #uiHideBtn"]=
this.uiHideFunc;b[a.cgti+" #portraitBtn"]=this.live2dPortrait;b[a.cgti+" #favoriteChara .tapArea"]=this.myProfile;b[a.cgti+" #announce"]=this.questionPopup;b[a.cgti+" #config"]=this.etcPopup;b[a.cgti+" #question"]=this.questionPopup;return b},initialize:function(b){this.l2dTouchCnt=0;c&&(this.live2dId=c.live2dId);this.live2dPortrait=!1;this.template=n.template(D);var d=this;l.ajaxSimpleGet(a.linkList.questionIsAnswered,"",function(b){console.log("questionAnser.res.isAnswered \x3d "+b.isAnswered);
a.storage.isQuestionAnswered=b.isAnswered;d.createDom()})},render:function(){this.$el.html(this.template({leaderCardId:c?c.displayCardId:10011,presentCount:f.presentCount?f.presentCount:0}));return this},createDom:function(){a.content.append(this.render().el);e.getBaseData(a.getNativeObj());e.setWebView();l.getPageJson().notifyMessage&&!a.notifyMessage&&(a.notifyMessage=l.getPageJson().notifyMessage);a.tapBlock(!0);h=this;if(l.getPageJson().interrupt)a.setGlobalView();else{f.loginBonusList&&(a.loginBonus=
f.loginBonusList);f.loginBonusPeriod&&(a.loginBonusPeriod=f.loginBonusPeriod);f.campaignList&&(a.campaignListLogin=f.campaignList);f.loginBonusCampaign&&(a.loginBonusCampaign=f.loginBonusCampaign);f.loginBonusCampaignList&&(a.loginBonusCampaignList=f.loginBonusCampaignList);if(f.supportPoint&&(a.supportPoint=f.supportPoint,f.supportBonus)){var b="ALL",d=0;n.each(f.supportBonus.attributeIdCountMap,function(a,g){a>d&&(d=a,b=g)});a.mostUseSupportAtt=b;console.log("common.mostUseSupportAtt: ",a.mostUseSupportAtt)}var k=
l.getPagePureJsons(),t=!1,g=!1,B=!1,C=!1;-1<k.indexOf("userDailyChallengeList")&&a.storage.userDailyChallengeList&&(g=t=!0,a.storage.userDailyChallengeList.reset(),delete a.storage.userDailyChallengeList);-1<k.indexOf("userTotalChallengeList")&&a.storage.userTotalChallengeList&&(B=t=!0,a.storage.userTotalChallengeList.reset(),delete a.storage.userTotalChallengeList);-1<k.indexOf("userLimitedChallengeList")&&a.storage.userLimitedChallengeList&&(C=t=!0,a.storage.userLimitedChallengeList.reset(),delete a.storage.userLimitedChallengeList);
t&&(k={},g&&(k.userDailyChallengeList=f.userDailyChallengeList),B&&(k.userTotalChallengeList=f.userTotalChallengeList),C&&(k.userLimitedChallengeList=f.userLimitedChallengeList),a.responseSetStorage(k));a.setGlobalView();!a.loginBonusCampaign&&!a.loginBonusCampaignList||this.loginBonusCampaignFlg||(a.loginBonusCampaignList||(a.loginBonusCampaignList=[],a.loginBonusCampaignList.push(a.loginBonusCampaign)),n.each(a.loginBonusCampaignList,function(b,d){n.findWhere(a.campaignListLogin,{id:b.campaignId});
b.imagePath&&(a.doc.createElement("img").src=b.imagePath);if(b.storyIds&&0<b.storyIds.length){b=b.storyIds.split(",");for(var g=b.length,c=[],k=0;k<g;k++){var e=a.storage.userQuestAdventureList.findWhere({adventureId:b[k]});"599999-0"==b[k]&&(e=!0);e||c.push(b[k])}a.loginBonusCampaignList[d].storyIds=c}}));h.popupFlgs();f.presentFlag&&a.addClass(a.doc.getElementById("present"),"anim");this.setBanner();c&&2<=c.live2dList.length&&(w.prototype.rootView=this,this.live2dListMake(),a.doc.querySelector("#live2dBtn").className=
"TE se_decide",a.scrollSet("mypageWearScrollOuter","scrollInner"));this.checkApCurePush()}a.ready.hide()},touch:function(b){b.preventDefault();if(!a.isScrolled()&&c)if(this.live2dTap)this.live2dTap=!1;else{b=b.originalEvent.changedTouches[0];b={id:c.charaId+this.live2dId,x:b.pageX,y:b.pageY};var d=c,k=[32,33,34,35];2<=d.episodeLevel&&k.push(36);3<=d.episodeLevel&&k.push(37);4<=d.episodeLevel&&k.push(38);5<=d.episodeLevel&&k.push(39);d=u;u++;u>=k.length&&(u=0);k=k[d]+1;8<=this.l2dTouchCnt&&(k=41);
b.voice="vo_char_"+c.charaId+"_"+c.live2dList[c.live2dIndex].voicePrefixNo+"_"+k;c.chara.doubleUnitFlg&&0===c.live2dIndex&&(b.subId=c.chara.doubleUnitLive2dDetail,b.subX=-60,b.subY=0,b.txtAdjustX=-200);e.storyMotionL2dVoice(b);this.l2dTouchCnt++}},live2dPortrait:function(b){b.preventDefault();if(!a.isScrolled()){a.tapBlock(!0);e.endL2d();b={};b.id=c.charaId+p.live2dId;b.x=Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2);b.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/
2);b.type=1;b.key="idle";var d=!1;c.chara.doubleUnitFlg&&0===c.live2dIndex&&(d=!0);this.live2dPortrait?(this.live2dPortrait=!1,e.changeBg(a.settingBg),a.removeClass(a.doc.querySelector(".live2dArea"),"portrait"),a.removeClass(a.doc.querySelector("#live2dMenu"),"portrait"),a.removeClass(a.doc.querySelector("#wearWrap"),"portrait"),a.doc.querySelector("#menu").style.display="",d&&(b.x=d?Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2)+180:Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/
2),b.subId=c.chara.doubleUnitLive2dDetail,b.subX=-60,b.subY=0)):(this.live2dPortrait=!0,b.isPortrait=!0,e.changeBg(a.settingBg,!0),a.addClass(a.doc.querySelector(".live2dArea"),"portrait"),a.addClass(a.doc.querySelector("#live2dMenu"),"portrait"),a.addClass(a.doc.querySelector("#wearWrap"),"portrait"),a.doc.querySelector("#menu").style.display="none",d&&(b.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/2)-120,b.x=Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2)+300,
b.subId=c.chara.doubleUnitLive2dDetail,b.subX=-300,b.subY=240));e.startL2d(b);setTimeout(function(){a.tapBlock(!1)},700)}},live2dSelectFunc:function(b){if(b&&(b.preventDefault(),a.isScrolled()))return;window.isBrowser&&window.isLocal||(this.wearChanging?(a.addClass(a.doc.getElementById("wearWrap"),"off"),a.tapBlock(!0),this.wearChanging=!1,a.removeClass(a.doc.getElementById("MyPage"),"wearing"),a.removeClass(a.doc.getElementById("globalMenuContainer"),"hide")):(a.removeClass(a.doc.getElementById("wearWrap"),
"off"),a.tapBlock(!0),this.wearChanging=!0,a.addClass(a.doc.getElementById("MyPage"),"wearing"),a.addClass(a.doc.getElementById("globalMenuContainer"),"hide")),setTimeout(function(){"MyPage"===a.location&&(a.scrollRefresh(),a.tapBlock(!1))},700))},live2dListMake:function(){if(!window.isBrowser||!window.isLocal){var b=a.doc.getElementById("mypageWearScrollOuter").getElementsByClassName("scrollInner")[0];b.innerHTML="";if(0<c.live2dList.length)n.each(c.live2dList,function(a,d){a=new w({model:a});b.appendChild(a.render().el)});
else{var d=new w({model:{live2dId:c.live2dId,description:"Magical Girls",voicePrefixNo:"00"}});b.appendChild(d.render().el)}}},live2dSelectTimer:function(b){this.l2dSlTimer&&clearTimeout(this.l2dSlTimer);var d=this;this.timerFire=this.l2dTimerStop=!1;this.l2dSlTimer=setTimeout(function(){"MyPage"!==a.location||d.l2dTimerStop||a.isDoubleTouch()||(d.timerFire=!0,d.live2dSelectFunc(b))},1E3)},live2dFuncRegacy:function(b){if(!this.timerFire&&(this.l2dTimerStop=!0,clearTimeout(this.l2dSlTimer),b.preventDefault(),
!a.isScrolled()&&!a.isDoubleTouch())){var d=b.currentTarget;a.addClass(b.currentTarget,"block");q=setTimeout(function(){d&&(a.removeClass(d,"block"),q=null)},1500);c.live2dIndex+=1;c.live2dList[c.live2dIndex]||(c.live2dIndex=0);this.live2dId=b=c.live2dList[c.live2dIndex].live2dId;x(b,null,this.live2dPortrait);this.live2dListMake()}},live2dFunc:function(b){a.addClass(a.doc.getElementById("wearWrap"),"block");q=setTimeout(function(){a.removeClass(a.doc.getElementById("wearWrap"),"block");q=null},1500);
c.live2dIndex=n.findIndex(c.live2dList,{live2dId:b});this.live2dId=b=c.live2dList[c.live2dIndex].live2dId;x(b,null,this.live2dPortrait)},uiHideFunc:function(b){b.preventDefault();if(!a.isScrolled()){var d=this;r=null;var c=function(b){r=setTimeout(function(){r=null;d.live2dTap=!0;e.startSe(1008);a.tapEffectStop=!1;a.doc.querySelector("#menu")&&a.doc.querySelector("#live2dMenu")&&(d.live2dPortrait||(a.doc.querySelector("#menu").style.display=""),a.doc.querySelector("#live2dMenu").style.display="",
document.getElementById("MyPage").removeEventListener("touchstart",c),document.getElementById("MyPage").removeEventListener(a.cgti,t))},800)},t=function(a){r&&clearTimeout(r)};b="uiHidePop";this.live2dPortrait&&(b="uiHidePop portrait");var g=new a.PopupClass({exClass:b,content:"This will hide all the buttons on screen.\x3cbr\x3e\x3cbr\x3eOnce the buttons are hidden, tap and\x3cbr\x3ehold on the screen to display them again.",decideBtnText:"Hide",closeBtnText:"Cancel",showCurtain:!1,canClose:!1},null,
function(){$(".uiHidePop .decideBtn").on(a.cgti,function(b){b.preventDefault();a.isScrolled()||(g.popupView.close(),a.doc.querySelector("#menu").style.display="none",a.doc.querySelector("#live2dMenu").style.display="none",a.tapEffectStop=!0,document.getElementById("MyPage").addEventListener("touchstart",c),document.getElementById("MyPage").addEventListener(a.cgti,t))})})}},myProfile:function(b){b.preventDefault();a.isScrolled()||require(["js/view/user/MyProfilePopup"],function(a){a.instantPopup()})},
questionPopup:function(b){if(b&&(b.preventDefault(),a.isScrolled()))return;a.tapBlock(!0);a.loading.show();m&&m.trigger("removeView");var d=this,c=6E4*((new Date).getTime()/6E4|0);require(["js/view/system/AnnounceView","text!template/user/AnnouncePopupTemp.html","text!json/event_banner/event_banner.json?bust\x3d"+c,"text!json/announcements/announcements.json?bust\x3d"+c],function(c,g,k,e){new a.PopupClass({title:"News",exClass:"announcementPopup",announce:!0},g,function(){setTimeout(function(){a.tapBlock(!1);
a.loading.hide()},500)},function(){m&&m.trigger("removeView");b||(d.firstPopFlg=!0,d.popupFlgs())});m=new c({bannerJson:k,announcementJson:e})})},announcePopup:function(b){if(b&&(b.preventDefault(),a.isScrolled()))return;a.tapBlock(!0);a.loading.show();m&&m.trigger("removeView");var d=this,c=6E4*((new Date).getTime()/6E4|0);require(["js/view/system/AnnounceView","text!template/user/AnnouncePopupTemp.html","text!json/event_banner/event_banner.json?bust\x3d"+c,"text!json/announcements/announcements.json?bust\x3d"+
c],function(c,g,e,k){new a.PopupClass({title:"News",exClass:"announcementPopup",announce:!0},g,function(){setTimeout(function(){a.tapBlock(!1);a.loading.hide()},500)},function(){m&&m.trigger("removeView");b||(d.firstPopFlg=!0,d.popupFlgs())});m=new c({bannerJson:e,announcementJson:k})})},etcPopup:function(b){b.preventDefault();a.isScrolled()||new a.PopupClass({title:"Others",popupType:"typeC",exClass:"etcPop"},G,function(){a.storage.gameUser&&a.storage.gameUser.toJSON().closeFunctions&&-1<a.storage.gameUser.toJSON().closeFunctions.indexOf("FRIEND")&&
a.addClass(a.doc.getElementById("popupArea").getElementsByClassName("friendBtn")[0],["grayScale","limited"]);window.isDebug&&a.doc.querySelector("#popupArea .backDoorBtn").addEventListener(a.cgti,h.backdoor)})},popupFlgs:function(){a.tapBlock(!0);if(h.rewardReceiveFlg)h.rewardReceiveFlg=!0,rewardReceiveHandler(),a.tapBlock(!1);else if(a.loginBonus&&!h.loginBonusFlg)h.loginBonusFlg=!0,h.loginBonusHandler();else if(a.loginBonusCampaignList&&!h.loginBonusCampaignFlg)a.loginBonusCampaignList[0].storyIds&&
0<a.loginBonusCampaignList[0].storyIds.length?h.loginBonusStory():h.campaignLoginCommon();else if("NOT_ANSWERED"!==f.gameUser.userReviewStatus||a.oneTimeReviewPopFlg||h.reviewFlg)if(f.userWarning&&!h.warningFlg)h.warningFlg=!0,h.warningPopHandler(),a.tapBlock(!1);else if(void 0===h.firstPopFlg){if(void 0===h.firstPopFlg){a.loading.show();var b=6E4*(Date.parse(l.getPageJson().currentTime)/6E4|0);require(["text!json/announcements/light_top50.json?bust\x3d"+b],function(b){b=JSON.parse(b);b=n.sortBy(b,
function(a){return a.startAt});for(var d=a.storage.gameUser.get("announcementViewAt")?Date.parse(a.storage.gameUser.get("announcementViewAt")):-1,c=b.length,g=-1,e=Date.parse(l.getPageJson().currentTime);0<c;){c--;var f=b[c].startAt.replace(/-/g,"/"),m=b[c].endAt.replace(/-/g,"/"),f=Date.parse(f),m=Date.parse(m);if(d<f&&e>=f&&m>e)if(b[c].displayOs&&"ALL"===b[c].displayOs)g=b[c].id,c=0;else if(a.ua.android&&"ANDROID"===b[c].displayOs||a.ua.ios&&"IOS"===b[c].displayOs)g=b[c].id,c=0}-1<g?(h.firstPopFlg=
!0,h.announcePopup()):(h.firstPopFlg=!1,a.loading.hide(),h.popupFlgs())})}}else a.notifyMessage&&!h.messageFlg?(h.messageFlg=!0,h.messagePopHandler(),a.tapBlock(!1)):!a.passWordNoticeFlg&&a.storage.gameUser.get("passwordNotice")&&a.storage.gameUser.toJSON().closeFunctions&&-1===a.storage.gameUser.toJSON().closeFunctions.indexOf("FRIEND")?(a.passWordNoticeFlg=!0,h.passwordPopHandler()):(x(null,!0),a.tapBlock(!1));else h.reviewFlg=!0,h.reviewPopHandler(),a.tapBlock(!1)},loginBonusHandler:function(){var b=
function(){h.popupFlgs()};require(["text!template/loginBonus/loginBonusPopupTemp.html"],function(d){new a.PopupClass({title:"Login Bonus",content:"",exClass:"loginBonusPop",popupType:"typeB"},null,function(){setTimeout(function(){a.tapBlock(!1)},500)},b);var c=n.sortBy(a.loginBonus,"day"),e=a.loginBonusPeriod,g=a.doc.createElement("div");d=n.template(d);var h=a.supportPoint?a.supportPoint:null,f=a.mostUseSupportAtt?a.mostUseSupportAtt:"ALL";g.innerHTML=d({gameUser:a.storage.gameUser.toJSON(),loginBonus:c,
period:e,supportPoint:h,helperAtt:f,currentTime:l.getPageJson().currentTime});a.doc.getElementById("popupArea").getElementsByClassName("popupTextArea")[0].appendChild(g);g=null})},campaignLoginCommon:function(){a.androidKeyStop=!0;a.tapBlock(!0);var b=function(){a.loginBonusCampaignList.splice(0,1);a.androidKeyStop=!1;0===a.loginBonusCampaignList.length&&(a.campaignListLogin=null,a.loginBonusCampaign=null,a.loginBonusCampaignList=null,h.loginBonusCampaignFlg=!0);h.popupFlgs()},d=n.findWhere(a.campaignListLogin,
{id:a.loginBonusCampaignList[0].campaignId});require(["text!template/loginBonus/loginBonusCampaignPopupTemp.html"],function(c){if(!a.loginBonusCampaignList[0].loginBonusList||1>a.loginBonusCampaignList[0].loginBonusList.length)a.tapBlock(!1),b();else{c=n.template(c);var k=new a.PopupClass({simple:!0},c({campaign:d,bonus:a.loginBonusCampaignList[0]}),function(){$(".itemPetal1").on("webkitAnimationStart",function(){$(".itemPetal1").off();e.startSe(1701)});a.loginBonusCampaignList[0].storyIds&&0!==a.loginBonusCampaignList[0].storyIds.length||
setTimeout(function(){a.addClass(a.doc.getElementById("campaignAnimationWrap"),"anim")},1E3);$(".itemPetal2").on("webkitAnimationEnd",function(){$(".itemPetal2").off();$("#campaignAnimationWrap").on(a.cgti,function(b){b&&(b.preventDefault(),a.isScrolled()||($("#campaignAnimationWrap").off(),e.startSe(1002),$("#campaignAnimationWrap").on("webkitAnimationEnd",function(){$("#campaignAnimationWrap").off();a.tapBlock(!1);$("#campaignAnimationWrap").on(a.cgti,function(b){b.preventDefault();a.isScrolled()||
($("#campaignAnimationWrap").off(),e.startSe(1003),k.popupView.close())})}),a.addClass(a.doc.getElementById("campaignAnimationWrap"),"fadeOut")))});a.tapBlock(!1)})},b);e.getBaseData(a.getNativeObj())}})},loginBonusStory:function(){a.androidKeyStop=!0;a.tapBlock(!0);var b=a.loginBonusCampaignList[0].storyIds,d=!1;a.loginBonusCampaignList[0].loginBonusList&&0<a.loginBonusCampaignList[0].loginBonusList.length&&(d=!0);var c=function(){$("#commandDiv").on("nativeCallback",function(c,k){k&&k.isSkipped&&
(c={},c.adventureId=String(b[0]),l.ajaxPost(a.linkList.adventureSkip,c,function(b){a.responseSetStorage(b)}));b.splice(0,1);0<b.length?l.ajaxPost(a.linkList.userQuestAdventureRegist,{adventureId:String(b[0])},function(d){"error"!==d.resultCode&&(a.responseSetStorage(d),e.startStory(String(b[0])))}):($("#commandDiv").off(),e.startBgm(a.bgm),e.changeBg(a.background),a.ready.target.className="show",e.setWebView(),a.ready.hide(),d?setTimeout(function(){a.addClass(a.doc.getElementById("campaignAnimationWrap"),
"anim")},2E3):(a.loginBonusCampaignList.splice(0,1),a.androidKeyStop=!1,0===a.loginBonusCampaignList.length&&(a.campaignListLogin=null,a.loginBonusCampaign=null,a.loginBonusCampaignList=null,h.loginBonusCampaignFlg=!0),h.popupFlgs()))});l.ajaxPost(a.linkList.userQuestAdventureRegist,{adventureId:String(b[0])},function(c){"error"!==c.resultCode&&(a.responseSetStorage(c),setTimeout(function(){e.setWebView(!1);e.startStory(String(b[0]));d&&h.campaignLoginCommon()},500))})};$(a.ready.target).on("webkitAnimationEnd",
function(){$(a.ready.target).off("webkitAnimationEnd");$(a.ready.target).on("webkitAnimationEnd",function(b){"readyFadeOut"==b.originalEvent.animationName&&(a.ready.target.className="")});e.changeBg("web_black.jpg");c()});if(window.isBrowser){a.tapBlock(!0);e.setWebView(!1);var f=function(c){"error"!==c.resultCode&&(a.responseSetStorage(c),b.splice(0,1),0<b.length?(e.startStory(String(b[0])),l.ajaxPost(a.linkList.userQuestAdventureRegist,{adventureId:String(b[0])},f)):d?setTimeout(function(){a.addClass(a.doc.getElementById("campaignAnimationWrap"),
"anim")},2E3):setTimeout(function(){e.setWebView(!0);a.tapBlock(!1)},1500))};l.ajaxPost(a.linkList.userQuestAdventureRegist,{adventureId:String(b[0])},f);d?h.campaignLoginCommon():setTimeout(function(){e.setWebView(!0);a.tapBlock(!1)},1500)}else a.addClass(a.ready.target,"preNativeFadeIn")},reviewPopHandler:function(){a.oneTimeReviewPopFlg=!0;var b=function(){l.ajaxPlainPost(a.linkList.rejectReview,"",function(b){b=JSON.parse(b);"error"!==b.resultCode&&(a.responseSetStorage(b),h.popupFlgs())})};require(["text!template/user/ReviewPopTemp.html"],
function(d){d=n.template(d);new a.PopupClass({title:"Message From Magia Record Operations Team",content:d(),exClass:"reviewPopup"},null,function(){setTimeout(function(){a.tapBlock(!1)},500)},b);var c=0;a.doc.getElementById("acceptReview").addEventListener(a.cgti,function(b){if(!(a.isScrolled()||0<c)){c++;b.preventDefault();b=null;a.ua.ios&&(b="https://apps.apple.com/us/app/magia-record-english/id1456974291?mt\x3d8\x26action\x3dwrite-review");a.ua.android&&(b="https://play.google.com/store/apps/details?id\x3dcom.aniplex.magireco.en\x26hl\x3den_US");
if(!window.isBrowser){if(!b)return;e.browserOpen(b)}a.g_popup_instance.remove();l.ajaxPlainPost(a.linkList.acceptReview,"",function(b){b=JSON.parse(b);"error"!==b.resultCode&&(a.responseSetStorage(b),h.popupFlgs())})}})})},warningPopHandler:function(){new a.PopupClass({title:"Message From Magia Record Operations Team",content:'\x3cdiv class\x3d"scrollInnerWrap"\x3e'+f.userWarning.warning+"\x3c/div\x3e",closeBtnText:"Confirmed",exClass:"warningPop"},null,function(){a.doc.getElementById("popupArea").getElementsByClassName("popupTextArea")[0].id=
"warningScroll";a.scrollSet("warningScroll","scrollInnerWrap")},function(){h.popupFlgs()})},messagePopHandler:function(){new a.PopupClass({title:"Message From Magia Record Operations Team",content:'\x3cdiv class\x3d"scrollInnerWrap"\x3e'+a.notifyMessage+"\x3c/div\x3e",closeBtnText:"OK",exClass:"warningPop"},null,function(){a.doc.getElementById("popupArea").getElementsByClassName("popupTextArea")[0].id="warningScroll";a.scrollSet("warningScroll","scrollInnerWrap");a.notifyMessage=null},function(){h.popupFlgs()})},
passwordPopHandler:function(){new a.PopupClass({title:"About Setting a Transfer Password",content:'\x3cdiv class\x3d"scrollInnerWrap"\x3eWith a transfer password, you can restore data even from a broken device.\x3cbr\x3e\x3cbr\x3eDo you wish to set up a password now?\x3cbr\x3e\x3cbr\x3e\x3cspan class\x3d"c_red"\x3eâ€»Without a password, you cannot transfer your data.\x3c/span\x3e\x3c/div\x3e',closeBtnText:"Cancel",decideBtnText:"Configure",exClass:"warningPop"},null,function(){a.doc.getElementById("popupArea").getElementsByClassName("popupTextArea")[0].id=
"warningScroll";a.scrollSet("warningScroll","scrollInnerWrap");$("#popupArea .decideBtn").on(a.cgti,function(b){b.preventDefault();a.isScrolled()||($("#popupArea .decideBtn").off(),location.href="#/ConfigTop")});a.tapBlock(!1)},function(){$("#popupArea .decideBtn").off();h.popupFlgs()})},rewardReceiveHandler:function(){new a.PopupClass({title:"Confirm to Receive",content:"Presents received.",closeBtnText:"OK"},null,null,function(){h.popupFlgs()})},checkApCurePush:function(){if(void 0!==a.noticeAp&&
!0===a.noticeAp){if(a.storage.userStatusList){var b=a.storage.userStatusList.findWhere({statusId:"ACP"}),c=a.storage.userStatusList.findWhere({statusId:"MAX_ACP"});b&&c&&(b.toJSON().point>=c.toJSON().point?e.noticeApFullSet(0):(b=a.getApRemainTime(b.toJSON(),c.toJSON(),l.getPageJson().currentTime),e.noticeApFullSet(b)))}}else if(void 0===a.noticeAp){var k=this;$("#configCallback").on("configCallback",function(b,c){$("#configCallback").off();a.noticeAp=1===c.ap?!0:!1;a.noticeAp&&k.checkApCurePush()});
e.noticeApConfig("configCallback")}},setBanner:function(){A.prototype.parentView=this;var b=6E4*((new Date).getTime()/6E4|0);require(["text!json/event_banner/event_banner.json?bust\x3d"+b],function(b){a.doc.getElementById("mypageBanner")&&(v=new A(b),a.doc.getElementById("mypageBanner").appendChild(v.render().el))})},backdoor:function(){if(window.isDebug){var b=function(){a.doc.querySelector("#content").classList.toggle("hide");"MyPage"===a.location&&a.scrollRefresh()};a.doc.querySelector("#content")?
b():require(["js/test/BackdoorList"],function(c){c=new c;a.doc.querySelector("#MyPage").appendChild(c.render().el);"MyPage"===a.location&&a.scrollSet("backdoorListWrap","backdoorList");b()})}},live2dSet:function(b){if(c&&c.live2dId!=this.live2dId){var d={};d.charaId=c.charaId;d.live2dId=this.live2dId;l.ajaxPost(a.linkList.live2dSet,d,function(d){a.responseSetStorage(d);d=d.userCharaList[0];var e=a.storage.userCharaList.findWhere({charaId:c.charaId});e.clear({silent:!0});e.set(d);b()})}else b()},removeFunc:function(a){this.trigger("l2dListRemove");
this.live2dSet(a)}}),w=z.View.extend({tagName:"div",className:function(){var a="commonFrame4 TE se_tabs wrap";this.rootView.live2dId===this.model.live2dId&&(a+=" current");return a},events:function(){var b={};b[a.cgti]=this.wearSelect;return b},initialize:function(){this.listenTo(this.rootView,"l2dListRemove",this.removeView)},render:function(){this.$el.text(this.model.description);return this},wearSelect:function(b){b.preventDefault();a.isScrolled()||this.el.classList.contains("current")||(a.removeClass(a.doc.getElementById("mypageWearScrollOuter").getElementsByClassName("current")[0],
"current"),a.addClass(this.el,"current"),this.rootView.live2dFunc(this.model.live2dId))},removeView:function(){this.off();this.remove()}}),H=function(){a.setStyle(E);console.log("common.tutorialId",a.tutorialId);console.log("common.tutorialUtil",a.tutorialUtil);f=l.getPageJson();n.has(f.user,"id")?n.has(f,"gameUser")?(F.createCardList(),c=(c=a.storage.userCardListEx.findWhere({id:f.gameUser.leaderId}))?a.storage.userCardListEx.findWhere({id:f.gameUser.leaderId}).toJSON():null,window.isBrowser?p=new y:
($("#commandDiv").on("nativeCallback",function(b,c){$("#commandDiv").off();""!==c?l.ajaxPost(a.linkList.rewardReceive,{serial:c},function(b){b.messageType?new a.PopupClass({title:"Confirm",content:"Failed to receive the promotion presents."+{INVALID:"Code Fail",DUPLICATE:"Received",OUT_OF_TERM:"Expired"}[b.messageType]+"]",closeBtnText:"OK"}):new a.PopupClass({title:"Confirm",content:"You received a Promotional Present. Check your present box!",closeBtnText:"OK"});e.deleteRewardPrm();p=new y}):p=
new y}),e.getRewardPrm()),a.questBattleModel=null,a.searchQuestGiftId=null):(new a.PopupClass({title:"Player Does Not Exist",popupId:"successPopup",content:"Returning to the Title Page",decideBtnText:"Title Page",canClose:!1},null,function(){a.doc.getElementsByClassName("decideBtn")[0].addEventListener(a.cgti,function(){e.nativeReload("#/TopPage")})}),a.tapBlock(!1)):e.nativeReload("#/TopPage")},x=function(b,d,h){if(c&&(b=b?c.charaId+b:c.charaId+c.live2dId)){var f=!1;c.chara.doubleUnitFlg&&0===c.live2dIndex&&
(f=!0);var g={};g.id=String(b);g.x=f?540:340;g.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/2);f&&(g.subId=c.chara.doubleUnitLive2dDetail,g.subX=-60,g.subY=0,g.txtAdjustX=-200);d?(u=0,g.type=0,g.key="vo_char_"+c.charaId+"_"+c.live2dList[c.live2dIndex].voicePrefixNo+"_"+(I()+1),e.endL2d(),setTimeout(function(){"MyPage"===a.location&&e.startL2d(g)},100)):c.chara.doubleUnitFlg?(g.type=1,g.key="idle",a.doc.getElementById("MyPage").classList.contains("menuHide")&&(g.x=f?Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/
2)+180:Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2)),h&&(g.x=Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2),g.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/2),g.isPortrait=!0,f&&(g.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/2)-120,g.x=Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2)+300,g.subId=c.chara.doubleUnitLive2dDetail,g.subX=-300,g.subY=240)),e.endL2d(),setTimeout(function(){"MyPage"===a.location&&e.startL2d(g)},
100)):(g.key="metamorphose",e.storyMotionL2d(g))}},I=function(){var b=[];if(a.loginBonus)return 23;var c=Number(f.currentTime.split(" ")[1].split(":")[0]),e=Number(f.currentTime.split(" ")[1].split(":")[1]);6<=c&&9>=c&&!(9==c&&0<e)?b.push(24):11<=c&&13>=c&&!(13==c&&0<e)?b.push(25):17<=c&&19>=c&&!(19==c&&0<e)?b.push(26):22<=c||0==c&&!(0==c&&0<e)?b.push(27):b.push(28);a.storage.userStatusList.findWhere({statusId:"ACP"}).toJSON().point>=a.storage.userStatusList.findWhere({statusId:"MAX_ACP"}).toJSON().point&&
b.push(29);a.storage.userStatusList.findWhere({statusId:"BTP"}).toJSON().point>=a.storage.userStatusList.findWhere({statusId:"MAX_BTP"}).toJSON().point&&b.push(30);return b[Math.floor(Math.random()*b.length)]};return{needModelIdObj:[{id:"user",refresh:!0},{id:"gameUser",refresh:!0},{id:"userStatusList",refresh:!0},{id:"userCharaList"},{id:"userCardList"},{id:"userDoppelList"},{id:"itemList"},{id:"userItemList"},{id:"giftList"},{id:"userGiftList"},{id:"userDailyChallengeList"},{id:"userTotalChallengeList"},
{id:"userLimitedChallengeList"},{id:"userGiftList"},{id:"pieceList"},{id:"userPieceList"},{id:"userPieceSetList"},{id:"userDeckList"},{id:"userLive2dList",refresh:!0},{id:"userQuestAdventureList"}],fetch:function(){e.stopMemoriaTop();e.endQuest();e.endArena();e.endL2d();e.hideMiniChara();e.popEventBranch();e.hideSubQuestBg();e.popEventSingleRaid();e.callTouchesClear();l.pageModelGet(this.needModelIdObj)},init:function(){H()},pageJson:function(){return l.getPageJson()},remove:function(b){p?p.removeFunc(function(){q&&
clearTimeout(q);q=null;p.remove();m&&m.trigger("removeView");a.loginBonus&&(a.loginBonus=null);v&&v.removeView();b()}):b()},firstPopup:function(){p.firstPopup()},startCommand:function(){e.changeBg(a.settingBg);e.startBgm(a.settingBgm)},menuShow:function(){a.tapBlock(!0);e.endL2d();"MyPage"===a.location&&a.removeClass(a.doc.getElementById("live2dMenu"),"show");a.removeClass(a.doc.getElementById("MyPage"),"menuHide");a.addClass(a.doc.getElementById("MyPage"),"menuShow");if(c){var b=!1;c.chara.doubleUnitFlg&&
0===c.live2dIndex&&(b=!0);var d={};d.id=c.charaId+p.live2dId;d.x=b?540:380;d.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/2);b&&(d.subId=c.chara.doubleUnitLive2dDetail,d.subX=-60,d.subY=0,d.txtAdjustX=-200);d.type=1;d.key="idle";e.startL2d(d)}setTimeout(function(){"MyPage"===a.location&&a.tapBlock(!1)},700)},menuHide:function(){a.tapBlock(!0);e.endL2d();a.removeClass(a.doc.getElementById("MyPage"),"menuShow");a.addClass(a.doc.getElementById("MyPage"),"menuHide");if(c){var b=!1;
c.chara.doubleUnitFlg&&0===c.live2dIndex&&(b=!0);var d={};d.id=c.charaId+p.live2dId;d.x=b?Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2)+180:Math.floor(a.doc.getElementsByTagName("body")[0].offsetWidth/2);d.y=Math.floor(a.doc.getElementsByTagName("body")[0].offsetHeight/2);b&&(d.subId=c.chara.doubleUnitLive2dDetail,d.subX=-60,d.subY=0,d.txtAdjustX=-200);d.type=1;d.key="idle";e.startL2d(d)}r&&clearTimeout(r);setTimeout(function(){"MyPage"===a.location&&(a.addClass(a.doc.getElementById("live2dMenu"),
"show"),a.tapBlock(!1))},700)},removeCommand:function(){e.endL2d()}}});